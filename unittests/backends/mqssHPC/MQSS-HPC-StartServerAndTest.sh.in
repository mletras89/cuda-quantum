#!/bin/bash

# ============================================================================ #
# Copyright (c) 2022 - 2024 NVIDIA Corporation & Affiliates.                   #
# All rights reserved.                                                         #
#                                                                              #
# This source code and the accompanying materials are made available under     #
# the terms of the Apache License 2.0 which accompanies this distribution.     #
# ============================================================================ #

# Launch the rabbitMQ Consumer
./RabbitMQ-Consumer &
# we'll need the process id to kill it
pid=$(echo "$!")
sleep 3
# Run the tests
./test-hpc-mqss
# Did they fail? 
testsPassed=$?
sleep 2
# kill the server
kill -INT $pid
# return success / failure
exit $testsPassed
